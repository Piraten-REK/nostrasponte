function konami(e){var t=new Array(10),r=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","KeyB","KeyA"];document.addEventListener("keydown",function(n){t.length>=10&&t.shift(),t.push(n.code),10===t.length&&t.every(function(e,t){return e===r[t]})&&e()})}function generateTetris(){var e;if(!window.tetris){window.tetris=!0;var t=document.createElement("div");t.id="tetris";var r=document.createElement("p"),n=document.createElement("div");n.classList.add("close"),n.addEventListener("click",function(){document.body.removeChild(t),window.tetris=!1});var o=document.createElement("style");o.innerHTML='#tetris{background:#fff;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:14pt;border-radius:5pt;box-shadow:0 0 5px red;animation:rainbow 5s linear infinite}#tetris p{text-align:center;font-weight:700;margin:0 0 5pt}#tetris p::before{content:"Score: ";font-weight:400}#tetris .close{position:absolute;top:2pt;right:2pt;cursor:pointer}#tetris .close::before{content:"\\e90a";color:#777;font-size:14pt;font-style:normal;font-variant:normal;font-weight:400;font-family:icomoon!important;line-height:1;speak:none;text-transform:none;vertical-align:middle}@keyframes rainbow{0%,100%{box-shadow:0 0 5pt red}14.2%{box-shadow:0 0 5pt orange}28.5%{box-shadow:0 0 5pt #ff0}42.9%{box-shadow:0 0 5pt green}57.1%{box-shadow:0 0 5pt #00f}71.4%{box-shadow:0 0 5pt indigo}85.7%{box-shadow:0 0 5pt violet}}';var i=document.createElement("canvas");e=[240,400],i.width=e[0],i.height=e[1];var a=i.getContext("2d");a.scale(20,20);var f=function(e,t){var r=[];for(;t--;)r.push(new Array(e).fill(0));return r}(12,20),c=[null,"#ff0d72","#0dc2ff","#0dff72","#f528ff","#ff8e0d","#ffe138","#3877ff"],s={pos:{x:0,y:0},matrix:null,score:0};document.addEventListener("keydown",function(e){switch(e.code){case"ArrowLeft":case"KeyA":m(-1);break;case"ArrowRight":case"KeyD":m(1);break;case"ArrowDown":case"KeyS":w();break;case"KeyQ":g(-1);break;case"KeyE":g(1)}}),v(),y(),function e(t){void 0===t&&(t=0);var r=t-u;u=t;l+=r;l>d&&w();a.fillStyle="#000",a.fillRect(0,0,i.width,i.height),p(f,{x:0,y:0}),p(s.matrix,s.pos);requestAnimationFrame(e)}(),function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=0,o=e;n<o.length;n++){var i=o[n];t.appendChild(i)}}(r,n,o,i),document.body.appendChild(t);var l=0,d=1e3,u=0}function h(e,t){for(var r=[t.matrix,t.pos],n=r[0],o=r[1],i=0;i<n.length;++i)for(var a=0;a<n[i].length;++a)if(0!==n[i][a]&&0!==(e[i+o.y]&&e[i+o.y][a+o.x]))return!0;return!1}function p(e,t){e.forEach(function(e,r){e.forEach(function(e,n){0!==e&&(a.fillStyle=c[e],a.fillRect(n+t.x,r+t.y,1,1))})})}function w(){s.pos.y++,h(f,s)&&(s.pos.y--,function(e,t){t.matrix.forEach(function(r,n){r.forEach(function(r,o){0!==r&&(e[n+t.pos.y][o+t.pos.x]=r)})})}(f,s),v(),function(){var e=1;e:for(var t=f.length-1;t>0;--t){for(var r=0;r<f[t].length;++r)if(0===f[t][r])continue e;var n=f.splice(t,1)[0].fill(0);f.unshift(n),++t,s.score+=10*e,e*=2}}(),y()),l=0}function m(e){s.pos.x+=e,h(f,s)&&(s.pos.x-=e)}function v(){s.matrix=function(e){switch(e){case"T":return[[1,1,1],[0,1,0],[0,0,0]];case"O":return[[2,2],[2,2]];case"L":return[[0,3,0],[0,3,0],[0,3,3]];case"J":return[[0,4,0],[0,4,0],[4,4,0]];case"I":return[[0,5,0,0],[0,5,0,0],[0,5,0,0],[0,5,0,0]];case"S":return[[0,6,6],[6,6,0],[0,0,0]];case"Z":return[[7,7,0],[0,7,7],[0,0,0]]}}("ILJOTSZ"["ILJOTSZ".length*Math.random()|0]),s.pos.y=0,s.pos.x=(f[0].length/2|0)-(s.matrix[0].length/2|0),h(f,s)&&(f.forEach(function(e){return e.fill(0)}),s.score=0,y())}function g(e){var t=s.pos.x,r=1;for(x(s.matrix,e);h(f,s);)if(s.pos.x+=r,(r=-(r+(r>0?1:-1)))>s.matrix[0].length)return x(s.matrix,-e),void(s.pos.x=t)}function x(e,t){for(var r,n=0;n<e.length;++n)for(var o=0;o<n;++o)r=[e[n][o],e[o][n]],e[o][n]=r[0],e[n][o]=r[1];t>0?e.forEach(function(e){return e.reverse()}):e.reverse()}function y(){r.innerText=s.score.toString()}}konami(generateTetris);